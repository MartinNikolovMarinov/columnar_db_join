# TEST 1

    insert into AC (A, C, V)
    values
    (1, 1, 11),
    (2, 1, 12),
    (3, 1, 13),
    (4, 2, 14),
    (5, 3, 15),
    (6, 2, 16),
    (7, 1, 17)

    insert into BC (B, C, V)
    values
    (8, 1, 18),
    (9, 2, 19),
    (10, 1, 20),
    (11, 2, 21),
    (12, 3, 22),
    (13, 2, 23),
    (14, 1, 24),
    (15, 1, 25)


    SELECT  ac.A as A,
    		bc.B as B,
            bc.C as C,
            ac.V as Column1,
            bc.V as Column2,
            (ac.V + bc.V) * (ac.V + bc.V) as SumSquared
    from AC as ac
    inner join BC as bc on ac.C = bc.C
    order by ac.A, bc.B, ac.C, ac.V, bc.V

    A	B	C	Column1	Column2	SumSquared
    1	8	1	11		18		841
    1	10	1	11		20		961
    1	14	1	11		24		1225
    1	15	1	11		25		1296
    2	8	1	12		18		900
    2	10	1	12		20		1024
    2	14	1	12		24		1296
    2	15	1	12		25		1369
    3	8	1	13		18		961
    3	10	1	13		20		1089
    3	14	1	13		24		1369
    3	15	1	13		25		1444
    4	9	2	14		19		1089
    4	11	2	14		21		1225
    4	13	2	14		23		1369
    5	12	3	15		22		1369
    6	9	2	16		19		1225
    6	11	2	16		21		1369
    6	13	2	16		23		1521
    7	8	1	17		18		1225
    7	10	1	17		20		1369
    7	14	1	17		24		1681
    7	15	1	17		25		1764

# TEST 2

    insert into ACE (A, C, E, V)
    values
    (10,  1, 2, 11),
    (21,  1, 1, 22),
    (32,  2, 1, 33),
    (43,  3, 4, 44),
    (54,  2, 1, 55),
    (65,  4, 2, 66),
    (76,  1, 3, 77),
    (77,  2, 1, 88),
    (18,  1, 1, 99),
    (29,  1, 1, 1010),
    (310, 1, 3, 1111),
    (411, 1, 2, 1212),
    (512, 2, 4, 1313),
    (613, 3, 2, 1414),
    (714, 2, 2, 1515),
    (715, 4, 4, 1616)

    insert into BCE (B, C, E, V)
    values
    (89, 3, 1, 144),
    (71, 4, 4, 104),
    (74, 3, 1, 16),
    (08, 4, 3, 121),
    (16, 2, 2, 44),
    (70, 4, 4, 151),
    (65, 1, 4, 33),
    (33, 3, 4, 143),
    (94, 4, 1, 51),
    (23, 3, 1, 117),
    (90, 1, 3, 198),
    (90, 1, 1, 157),
    (42, 1, 1, 120),
    (93, 1, 2, 10),
    (77, 2, 2, 46),
    (24, 4, 1, 115)


    SELECT  ace.A as A,
    		bce.B as B,
            bce.C as C,
            bce.E as E,
            ace.V as Column1,
            bce.V as Column2,
    		(ace.V + bce.V) * (ace.V + bce.V) as SumSquared
    from ACE as ace
    inner join BCE as bce on ace.C = bce.C and ace.E = bce.E
    order by ace.A, bce.B, bce.C, bce.E, ace.V, bce.V

    A	B	C	E	Column1	Column2	SumSquared
    10	93	1	2	11		10 		441
    18	42	1	1	99	    120		47961
    18	90	1	1	99		157		65536
    21	42	1	1	22		120		20164
    21	90	1	1	22		157		32041
    29	42	1	1	1010	120		1276900
    29	90	1	1	1010	157		1361889
    43	33	3	4	44		143		34969
    76	90	1	3	77		198		75625
    310	90	1	3	1111	198		1713481
    411	93	1	2	1212	10		1493284
    714	16	2	2	1515	44		2430481
    714	77	2	2	1515	46		2436721
    715	70	4	4	1616	151		3122289
    715	71	4	4	1616	104		2958400

# Test 3

    insert into AB (A, B, V)
    values
    (42, 0, 1),
    (42, 1, 3),
    (42, 7, 5),
    (42, 8, 5),
    (85, 1, 3),
    (86, 1, 7),
    (86, 2, 0)

    insert into BC (B, C, V)
    values
    (1, 9, 12),
    (2, 6, 5)

    insert into ACD (A, C, D, V)
    values
    (42, 9, 7, 4),
    (42, 10, 8, 5),
    (86, 2, 9, 17),
    (86, 6, 10, 3),
    (86, 9, 11, 19),
    (86, 9, 17, 7),
    (86, 32, 12, 5),
    (92, 7, 13, 5)


    select
        ab.A,
        ab.B,
        bc.C,
        acd.D,
        ab.V as Column1,
        bc.V as Column2,
        acd.V as Column3,
        (ab.V + bc.V + acd.V) * (ab.V + bc.V + acd.V) as "Sum^2"
    from AB as ab
    join BC as bc on bc.B = ab.B
    join ACD as acd on ab.A = acd.A and bc.C = acd.C
    order by ab.A, ab.B, acd.D, ab.V, bc.V, acd.V

    A   B   C   D   Column1 Column2 Column3 Sum^2
    42  1   9   7   3       12      4       361
    86  1   9   11  7       12      19      1444
    86  1   9   17  7       12      7       676
    86  2   6   10  0       5       3       64


# Test 4

    insert into D (D, V)
    values
    (57, 72),
    (72, 565),
    (156, 481),
    (252, 457),
    (467, 360),
    (490, 68),
    (747, 762),
    (760, 155),
    (845, 884),
    (955, 402)

    insert into AB (A, B, V)
    values
    (28, 174, 981),
    (32, 403, 712),
    (250, 855, 339),
    (256, 754, 431),
    (294, 613, 428),
    (326, 46, 207),
    (357, 224, 655),
    (381, 980, 409),
    (391, 943, 102),
    (895, 388, 526)


    select
        ab.A,
        ab.B,
        d.D,
        ab.V as Column1,
        d.V as Column2,
        (ab.V + d.V) * (ab.V + d.V) as "Sum^2"
    from D_Corner as d
    join AB_Corner as ab
    order by ab.A, ab.B, d.D

    A	B	D	Column1	Column2	Sum^2
    28	174	57	981	72	1108809
    28	174	72	981	565	2390116
    28	174	156	981	481	2137444
    28	174	252	981	457	2067844
    28	174	467	981	360	1798281
    28	174	490	981	68	1100401
    28	174	747	981	762	3038049
    28	174	760	981	155	1290496
    28	174	845	981	884	3478225
    28	174	955	981	402	1912689
    32	403	57	712	72	614656
    32	403	72	712	565	1630729
    32	403	156	712	481	1423249
    32	403	252	712	457	1366561
    32	403	467	712	360	1149184
    32	403	490	712	68	608400
    32	403	747	712	762	2172676
    32	403	760	712	155	751689
    32	403	845	712	884	2547216
    32	403	955	712	402	1240996
    250	855	57	339	72	168921
    250	855	72	339	565	817216
    250	855	156	339	481	672400
    250	855	252	339	457	633616
    250	855	467	339	360	488601
    250	855	490	339	68	165649
    250	855	747	339	762	1212201
    250	855	760	339	155	244036
    250	855	845	339	884	1495729
    250	855	955	339	402	549081
    256	754	57	431	72	253009
    256	754	72	431	565	992016
    256	754	156	431	481	831744
    256	754	252	431	457	788544
    256	754	467	431	360	625681
    256	754	490	431	68	249001
    256	754	747	431	762	1423249
    256	754	760	431	155	343396
    256	754	845	431	884	1729225
    256	754	955	431	402	693889
    294	613	57	428	72	250000
    294	613	72	428	565	986049
    294	613	156	428	481	826281
    294	613	252	428	457	783225
    294	613	467	428	360	620944
    294	613	490	428	68	246016
    294	613	747	428	762	1416100
    294	613	760	428	155	339889
    294	613	845	428	884	1721344
    294	613	955	428	402	688900
    326	46	57	207	72	77841
    326	46	72	207	565	595984
    326	46	156	207	481	473344
    326	46	252	207	457	440896
    326	46	467	207	360	321489
    326	46	490	207	68	75625
    326	46	747	207	762	938961
    326	46	760	207	155	131044
    326	46	845	207	884	1190281
    326	46	955	207	402	370881
    357	224	57	655	72	528529
    357	224	72	655	565	1488400
    357	224	156	655	481	1290496
    357	224	252	655	457	1236544
    357	224	467	655	360	1030225
    357	224	490	655	68	522729
    357	224	747	655	762	2007889
    357	224	760	655	155	656100
    357	224	845	655	884	2368521
    357	224	955	655	402	1117249
    381	980	57	409	72	231361
    381	980	72	409	565	948676
    381	980	156	409	481	792100
    381	980	252	409	457	749956
    381	980	467	409	360	591361
    381	980	490	409	68	227529
    381	980	747	409	762	1371241
    381	980	760	409	155	318096
    381	980	845	409	884	1671849
    381	980	955	409	402	657721
    391	943	57	102	72	30276
    391	943	72	102	565	444889
    391	943	156	102	481	339889
    391	943	252	102	457	312481
    391	943	467	102	360	213444
    391	943	490	102	68	28900
    391	943	747	102	762	746496
    391	943	760	102	155	66049
    391	943	845	102	884	972196
    391	943	955	102	402	254016
    895	388	57	526	72	357604
    895	388	72	526	565	1190281
    895	388	156	526	481	1014049
    895	388	252	526	457	966289
    895	388	467	526	360	784996
    895	388	490	526	68	352836
    895	388	747	526	762	1658944
    895	388	760	526	155	463761
    895	388	845	526	884	1988100
    895	388	955	526	402	861184

    expected total is 93553260

# Test 5

    insert into AB (A, B, V)
    values
    (1, 2, 11)
    (1, 3, 12)
    (1, 7, 13)
    (3, 8, 14)

    insert into AC (A, C, V)
    values
    (1, 2, 15),
    (1, 3, 16),
    (2, 4, 17),
    (3, 5, 18)

    select
        ab.A,
        ab.B,
        ac.C,
        ab.V as Column1,
        ac.V as Column2,
        (ab.V + ac.V) * (ab.V + ac.V) as "Sum^2"
    from AB as ab
    join Ac as ac on ab.A = ac.A
    order by ab.A, ab.B, ac.C, ab.V, ac.V

    A	B	C	Column1	Column2	Sum^2
    1	2	2	11	    15	    676
    1	2	3	11	    16	    729
    1	3	2	12	    15	    729
    1	3	3	12	    16	    784
    1	7	2	13	    15	    784
    1	7	3	13	    16	    841
    3	8	5	14	    18	    1024

    expected total is 5567

# helper queries

ALTER TABLE AC RENAME COLUMN B to C;

DELETE FROM AC;
